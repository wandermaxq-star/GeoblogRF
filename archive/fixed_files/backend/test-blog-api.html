<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –±–ª–æ–≥–æ–≤</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
        .warning { background-color: #fff3cd; border-color: #ffeaa7; }
        button { padding: 10px 15px; margin: 5px; cursor: pointer; }
        pre { background: #f8f9fa; padding: 10px; border-radius: 3px; overflow-x: auto; max-height: 200px; }
        .count { font-size: 1.2em; font-weight: bold; color: #007bff; }
    </style>
</head>
<body>
    <h1>üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–ª–æ–≥–æ–≤</h1>
    
    <div class="section">
        <h3>üìç –ú–∞—Ä–∫–µ—Ä—ã</h3>
        <button onclick="checkMarkers()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–∞—Ä–∫–µ—Ä—ã</button>
        <div id="markers-result"></div>
    </div>
    
    <div class="section">
        <h3>üìÖ –°–æ–±—ã—Ç–∏—è</h3>
        <button onclick="checkEvents()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–±—ã—Ç–∏—è</button>
        <div id="events-result"></div>
    </div>
    
    <div class="section">
        <h3>üìù –ë–ª–æ–≥–∏</h3>
        <button onclick="checkBlogs()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–ª–æ–≥–∏</button>
        <div id="blogs-result"></div>
    </div>
    
    <div class="section">
        <h3>üìö –ö–Ω–∏–≥–∏</h3>
        <button onclick="checkBooks()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–Ω–∏–≥–∏</button>
        <div id="books-result"></div>
    </div>
    
    <div class="section">
        <h3>üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h3>
        <button onclick="getRecommendations()">–ü–æ–ª—É—á–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</button>
        <div id="recommendations-result"></div>
    </div>

    <script>
        const API_BASE = 'http://localhost:3002/api';
        
        async function checkMarkers() {
            const resultDiv = document.getElementById('markers-result');
            resultDiv.innerHTML = '‚è≥ –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∞—Ä–∫–µ—Ä–æ–≤...';
            
            try {
                const response = await fetch(`${API_BASE}/markers`);
                const markers = await response.json();
                
                if (response.ok) {
                    resultDiv.className = 'success';
                    resultDiv.innerHTML = `
                        <div class="count">–ù–∞–π–¥–µ–Ω–æ –º–∞—Ä–∫–µ—Ä–æ–≤: ${markers.length}</div>
                        ${markers.length > 0 ? `
                            <h4>–ü—Ä–∏–º–µ—Ä—ã:</h4>
                            <pre>${JSON.stringify(markers.slice(0, 3).map(m => ({
                                id: m.id,
                                title: m.title,
                                category: m.category
                            })), null, 2)}</pre>
                        ` : '<p>‚ùå –ú–∞—Ä–∫–µ—Ä–æ–≤ –Ω–µ—Ç - —Å–æ–∑–¥–∞–π—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∞—Ä–∫–µ—Ä–æ–≤ –Ω–∞ –∫–∞—Ä—Ç–µ</p>'}
                    `;
                } else {
                    resultDiv.className = 'error';
                    resultDiv.innerHTML = `<p>‚ùå –û—à–∏–±–∫–∞: ${response.status}</p>`;
                }
            } catch (error) {
                resultDiv.className = 'error';
                resultDiv.innerHTML = `<p>üí• –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: ${error.message}</p>`;
            }
        }
        
        async function checkEvents() {
            const resultDiv = document.getElementById('events-result');
            resultDiv.innerHTML = '‚è≥ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–±—ã—Ç–∏–π...';
            
            try {
                const response = await fetch(`${API_BASE}/events`);
                const events = await response.json();
                
                if (response.ok) {
                    resultDiv.className = 'success';
                    resultDiv.innerHTML = `
                        <div class="count">–ù–∞–π–¥–µ–Ω–æ —Å–æ–±—ã—Ç–∏–π: ${events.length}</div>
                        ${events.length > 0 ? `
                            <h4>–ü—Ä–∏–º–µ—Ä—ã:</h4>
                            <pre>${JSON.stringify(events.slice(0, 3).map(e => ({
                                id: e.id,
                                title: e.title,
                                date: e.date
                            })), null, 2)}</pre>
                        ` : '<p>‚ùå –°–æ–±—ã—Ç–∏–π –Ω–µ—Ç - —Å–æ–∑–¥–∞–π—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ–±—ã—Ç–∏–π –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ</p>'}
                    `;
                } else {
                    resultDiv.className = 'error';
                    resultDiv.innerHTML = `<p>‚ùå –û—à–∏–±–∫–∞: ${response.status}</p>`;
                }
            } catch (error) {
                resultDiv.className = 'error';
                resultDiv.innerHTML = `<p>üí• –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: ${error.message}</p>`;
            }
        }
        
        async function checkBlogs() {
            const resultDiv = document.getElementById('blogs-result');
            resultDiv.innerHTML = '‚è≥ –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–ª–æ–≥–æ–≤...';
            
            try {
                const response = await fetch(`${API_BASE}/blogs`);
                const blogs = await response.json();
                
                if (response.ok) {
                    resultDiv.className = 'success';
                    resultDiv.innerHTML = `
                        <div class="count">–ù–∞–π–¥–µ–Ω–æ –±–ª–æ–≥–æ–≤: ${blogs.length}</div>
                        ${blogs.length > 0 ? `
                            <h4>–ü—Ä–∏–º–µ—Ä—ã:</h4>
                            <pre>${JSON.stringify(blogs.slice(0, 3).map(b => ({
                                id: b.id,
                                title: b.title,
                                hasConstructorData: !!b.constructor_data
                            })), null, 2)}</pre>
                        ` : '<p>‚ùå –ë–ª–æ–≥–æ–≤ –Ω–µ—Ç - —Å–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –±–ª–æ–≥</p>'}
                    `;
                } else {
                    resultDiv.className = 'error';
                    resultDiv.innerHTML = `<p>‚ùå –û—à–∏–±–∫–∞: ${response.status}</p>`;
                }
            } catch (error) {
                resultDiv.className = 'error';
                resultDiv.innerHTML = `<p>üí• –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: ${error.message}</p>`;
            }
        }
        
        async function checkBooks() {
            const resultDiv = document.getElementById('books-result');
            resultDiv.innerHTML = '‚è≥ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–Ω–∏–≥...';
            
            try {
                const response = await fetch(`${API_BASE}/books`);
                const books = await response.json();
                
                if (response.ok) {
                    resultDiv.className = 'success';
                    resultDiv.innerHTML = `
                        <div class="count">–ù–∞–π–¥–µ–Ω–æ –∫–Ω–∏–≥: ${books.length}</div>
                        ${books.length > 0 ? `
                            <h4>–ü—Ä–∏–º–µ—Ä—ã:</h4>
                            <pre>${JSON.stringify(books.slice(0, 3).map(b => ({
                                id: b.id,
                                title: b.title,
                                category: b.category
                            })), null, 2)}</pre>
                        ` : '<p>‚ùå –ö–Ω–∏–≥ –Ω–µ—Ç - —Å–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—É—é –∫–Ω–∏–≥—É</p>'}
                    `;
                } else {
                    resultDiv.className = 'error';
                    resultDiv.innerHTML = `<p>‚ùå –û—à–∏–±–∫–∞: ${response.status}</p>`;
                }
            } catch (error) {
                resultDiv.className = 'error';
                resultDiv.innerHTML = `<p>üí• –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: ${error.message}</p>`;
            }
        }
        
        async function getRecommendations() {
            const resultDiv = document.getElementById('recommendations-result');
            resultDiv.innerHTML = '‚è≥ –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö...';
            
            try {
                // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
                const [markersRes, eventsRes, blogsRes, booksRes] = await Promise.all([
                    fetch(`${API_BASE}/markers`),
                    fetch(`${API_BASE}/events`),
                    fetch(`${API_BASE}/blogs`),
                    fetch(`${API_BASE}/books`)
                ]);
                
                const markers = markersRes.ok ? await markersRes.json() : [];
                const events = eventsRes.ok ? await eventsRes.json() : [];
                const blogs = blogsRes.ok ? await blogsRes.json() : [];
                const books = booksRes.ok ? await booksRes.json() : [];
                
                let recommendations = [];
                
                if (markers.length === 0) {
                    recommendations.push('‚ùå –°–æ–∑–¥–∞–π—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∞—Ä–∫–µ—Ä–æ–≤ –Ω–∞ –∫–∞—Ä—Ç–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫—Ä—é—á–∫–æ–≤ —Å –º–µ—Ç–∫–∞–º–∏');
                } else {
                    recommendations.push('‚úÖ –ú–∞—Ä–∫–µ—Ä—ã –µ—Å—Ç—å - –º–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∫—Ä—é—á–∫–∏ —Å –º–µ—Ç–∫–∞–º–∏');
                }
                
                if (events.length === 0) {
                    recommendations.push('‚ùå –°–æ–∑–¥–∞–π—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ–±—ã—Ç–∏–π –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫—Ä—é—á–∫–æ–≤ —Å —Å–æ–±—ã—Ç–∏—è–º–∏');
                } else {
                    recommendations.push('‚úÖ –°–æ–±—ã—Ç–∏—è –µ—Å—Ç—å - –º–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∫—Ä—é—á–∫–∏ —Å —Å–æ–±—ã—Ç–∏—è–º–∏');
                }
                
                if (blogs.length === 0) {
                    recommendations.push('‚ùå –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –±–ª–æ–≥ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏');
                } else {
                    recommendations.push('‚úÖ –ë–ª–æ–≥–∏ –µ—Å—Ç—å - –º–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Å–º–æ—Ç—Ä');
                }
                
                if (books.length === 0) {
                    recommendations.push('‚ùå –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—É—é –∫–Ω–∏–≥—É –¥–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –±–ª–æ–≥–æ–≤');
                } else {
                    recommendations.push('‚úÖ –ö–Ω–∏–≥–∏ –µ—Å—Ç—å - –º–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –∫–Ω–∏–≥');
                }
                
                resultDiv.className = 'warning';
                resultDiv.innerHTML = `
                    <h4>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:</h4>
                    <ul>
                        <li>–ú–∞—Ä–∫–µ—Ä—ã: ${markers.length}</li>
                        <li>–°–æ–±—ã—Ç–∏—è: ${events.length}</li>
                        <li>–ë–ª–æ–≥–∏: ${blogs.length}</li>
                        <li>–ö–Ω–∏–≥–∏: ${books.length}</li>
                    </ul>
                    
                    <h4>üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:</h4>
                    <ul>
                        ${recommendations.map(r => `<li>${r}</li>`).join('')}
                    </ul>
                    
                    <h4>üöÄ –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:</h4>
                    <ol>
                        <li>–û—Ç–∫—Ä–æ–π—Ç–µ <a href="http://localhost:5173/blogs" target="_blank">http://localhost:5173/blogs</a></li>
                        <li>–ù–∞–∂–º–∏—Ç–µ "–°–æ–∑–¥–∞—Ç—å –±–ª–æ–≥"</li>
                        <li>–ù–∞–∂–º–∏—Ç–µ "–î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç"</li>
                        <li>–í—ã–±–µ—Ä–∏—Ç–µ –º–∞—Ä–∫–µ—Ä –∏–ª–∏ —Å–æ–±—ã—Ç–∏–µ</li>
                        <li>–û–ø—É–±–ª–∏–∫—É–π—Ç–µ –±–ª–æ–≥</li>
                        <li>–û—Ç–∫—Ä–æ–π—Ç–µ –±–ª–æ–≥ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</li>
                    </ol>
                `;
                
            } catch (error) {
                resultDiv.className = 'error';
                resultDiv.innerHTML = `<p>üí• –û—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞: ${error.message}</p>`;
            }
        }
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.onload = function() {
            setTimeout(() => {
                checkMarkers();
                checkEvents();
                checkBlogs();
                checkBooks();
                getRecommendations();
            }, 1000);
        };
    </script>
</body>
</html>

